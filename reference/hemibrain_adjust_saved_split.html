<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Manually review split neurons and save your results to a Google Sheet for everyone to use — hemibrain_task_update • hemibrainr</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Manually review split neurons and save your results to a Google Sheet for everyone to use — hemibrain_task_update" />
<meta property="og:description" content="A 3D interactive pipeline for reviewing our hemibrain_precomputed_splitpoints. Each user can
manually edit neurons if needs be, add whether or not they have a soma or are cropped, and make additional notes. The purpose of this
function if for interested users to work together to curate axon-dendrite splits suggested by the flow_centrality algorithm.
Currently, this function is built to review our most promising set of split points (hemibrain_splitpoints_polypre_centrifugal_synapses).
As the google sheet gets updated, new manual splits will be re-saved into this package, as hemibrain_manual_splitpoints and implemented as default for those neurons
when using hemibrain_flow_centrality and hemibrain_read_neurons.For this function to work, you may have to add
the Google Sheet database to your Google Drive." />
<meta property="og:image" content="/logo.svg" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hemibrainr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/flyconnectome/hemibrainr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Manually review split neurons and save your results to a Google Sheet for everyone to use</h1>
    <small class="dont-index">Source: <a href='https://github.com/flyconnectome/hemibrainr/blob/master/R/hemibrain_save_split.R'><code>R/hemibrain_save_split.R</code></a></small>
    <div class="hidden name"><code>hemibrain_adjust_saved_split.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>A 3D interactive pipeline for reviewing our <code><a href='hemibrain_precomputed_splitpoints.html'>hemibrain_precomputed_splitpoints</a></code>. Each user can
manually edit neurons if needs be, add whether or not they have a soma or are cropped, and make additional notes. The purpose of this
function if for interested users to work together to curate axon-dendrite splits suggested by the <code><a href='flow_centrality.html'>flow_centrality</a></code> algorithm.
Currently, this function is built to review our most promising set of split points (<code><a href='hemibrain_precomputed_splitpoints.html'>hemibrain_splitpoints_polypre_centrifugal_synapses</a></code>).
As the google sheet gets updated, new manual splits will be re-saved into this package, as <code>hemibrain_manual_splitpoints</code> and implemented as default for those neurons
when using <code><a href='hemibrain_flow_centrality.html'>hemibrain_flow_centrality</a></code> and <code><a href='hemibrain_read_neurons.html'>hemibrain_read_neurons</a></code>.For this function to work, you may have to add
the <a href='https://docs.google.com/spreadsheets/d/1YjkVjokXL4p4Q6BR-rGGGKWecXU370D1YMc1mgUYr8E/edit?usp=sharing'>Google Sheet database</a> to your Google Drive.</p>
    </div>

    <pre class="usage"><span class='fu'>hemibrain_task_update</span>(
  <span class='no'>bodyids</span>,
  <span class='no'>update</span>,
  <span class='kw'>selected_file</span> <span class='kw'>=</span> <span class='st'>"1YjkVjokXL4p4Q6BR-rGGGKWecXU370D1YMc1mgUYr8E"</span>,
  <span class='kw'>column</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"soma"</span>, <span class='st'>"cut"</span>, <span class='st'>"truncated"</span>, <span class='st'>"manual_edit"</span>, <span class='st'>"splittable"</span>, <span class='st'>"checked"</span>,
    <span class='st'>"user"</span>, <span class='st'>"time"</span>, <span class='st'>"note"</span>, <span class='st'>"priority"</span>, <span class='st'>"edited.cable"</span>, <span class='st'>"skeletonization"</span>)
)

<span class='fu'>hemibrain_adjust_saved_split</span>(
  <span class='kw'>bodyids</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>phases</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"complete"</span>, <span class='st'>"I"</span>, <span class='st'>"II"</span>, <span class='st'>"III"</span>),
  <span class='kw'>db</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>check_thresh</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>batch_size</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>by.type</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>assignments</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>brain</span> <span class='kw'>=</span> <span class='kw pkg'>hemibrainr</span><span class='kw ns'>::</span><span class='no'><a href='hemibrain.surf.html'>hemibrain.surf</a></span>,
  <span class='kw'>update_regularly</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>motivate</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>clean</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>prioritise</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>selected_file</span> <span class='kw'>=</span> <span class='st'>"1YjkVjokXL4p4Q6BR-rGGGKWecXU370D1YMc1mgUYr8E"</span>,
  <span class='kw'>selected_col</span> <span class='kw'>=</span> <span class='st'>"#fadadd"</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>bodyids</th>
      <td><p>bodyids which specify individual neurons, as used in the relevant neuPrint project</p></td>
    </tr>
    <tr>
      <th>update</th>
      <td><p>a vector of <code><a href='https://rdrr.io/r/base/length.html'>length(bodyids)</a></code> or <code>1</code>, which will replace cells in the column specified by <code>column</code> for given bodyids (<code>bodyids</code>).
E.g. If I wanted to changed the given bodyids on the task sheet to checked = TRUE, I would use <code>update = TRUE</code>.</p></td>
    </tr>
    <tr>
      <th>selected_file</th>
      <td><p>an optional path to a yaml file that already contains a selection</p></td>
    </tr>
    <tr>
      <th>column</th>
      <td><p>the column in the split-check task's Google Sheet (specified by <code>selected_file</code>) to be updated with the value of the argument <code>update</code>.
E.g. If I wanted to changed the given bodyids on the task sheet to checked = TRUE, I would use <code>column = "check"</code>.</p></td>
    </tr>
    <tr>
      <th>phases</th>
      <td><p>which Phases of the split check process you want to engage with. Phase I involves choosing which neurons need to be manually split,
making notes on them and marking if they are truncated by by the volume or not Phase II involves manually splitting those neurons that have been flagged as
as in need to splitting. And Phase III involves reviewing the manual splits that have been made, and re-splitting neurons if needs be. The default, complete,
is to go through all three phases with sequential batches of neurons, of <code>batch_size</code>.</p></td>
    </tr>
    <tr>
      <th>db</th>
      <td><p>a <code>neuronlist</code> object to act as a database of neuron skeletons. If you want to provide all
hemibrain neurons that could possibly be split, then you can use <code><a href='hemibrain_download_neurons.html'>hemibrain_download_neurons</a></code> to download
all hemibrain neurons as a <code><a href='https://rdrr.io/pkg/nat/man/neuronlistfh.html'>nat::neuronlistfh</a></code> file. All neurons can be read
using <code>db = hemibrain_read_neurons(savedir=TRUE)</code>. This can then be given as the argument to <code>db</code>.</p></td>
    </tr>
    <tr>
      <th>check_thresh</th>
      <td><p>when checking skeleton splits and correcting them, we do not want to look at skeletons that have already been checked by others many times.
If a skeleton has already been checked by this many users or more, it will not be given to the user to edit.</p></td>
    </tr>
    <tr>
      <th>batch_size</th>
      <td><p>when reviewing splits for hemibrain neurons, we examine neurons (or putative cell types, see parameter <code>by.type</code>) in batches of this size. We then go through two phases,
choosing neurons that are incorrect in some way (wrongly split, cropped) and then editing them manually, before saving them to a Google Sheet.
You may not have access to this Google Sheet, in which case you will not be able to contribute manual splits for neurons to this package. Contact us
if you would like access.</p></td>
    </tr>
    <tr>
      <th>by.type</th>
      <td><p>logical. If <code>TRUE</code> then putative cell types (as assigned as the type field in neuPrint) of neurons are presented. The number of cell types pulled
are of size <code>batch_size</code>.</p></td>
    </tr>
    <tr>
      <th>assignments</th>
      <td><p>logical. If TRUE then the user is invited to examine only neurons that they are flagged for them. These are entries into the 'roots' tab of the Google Sheet,
where the user column is the same as the initials the user enters.</p></td>
    </tr>
    <tr>
      <th>brain</th>
      <td><p>which brain to plot while splitting neuron. If <code>NULL</code> no brain is plotted. Otherwise
it is recommended to use <code>hemibrain.surf</code> (which is in raw voxel space).</p></td>
    </tr>
    <tr>
      <th>update_regularly</th>
      <td><p>whether or not to read from the Google Sheet database regularly, to avoid duplicating manual splits. Should be set to <code>TRUE</code> unless
reading the Google Sheet introduces a prohibitive time delay.</p></td>
    </tr>
    <tr>
      <th>motivate</th>
      <td><p>whether or not to plot 2D motivationals from <a href='(https://inspirobot.me/)'>InspiroBot</a> to keep to entertained while splitting neurons.</p></td>
    </tr>
    <tr>
      <th>clean</th>
      <td><p>whether or not to set synapse-less branches to <code>Label = 0</code>.</p></td>
    </tr>
    <tr>
      <th>prioritise</th>
      <td><p>whether or not to look at higher priority neurons first. Initial, this means olfactory system neurons.</p></td>
    </tr>
    <tr>
      <th>selected_col</th>
      <td><p>the color in which selected neurons (such as those specified in selected_file) should be plotted</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional arguments passed to plotting functions, such as <code>plot3d_split</code> and <code>nlscan_split</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Updates a Google Sheet which records whether neurons have been checked in one tab ("roots") and records actual manually made splits in a second tab ("manual").</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>the pipeline works in three phases and you choose to take a batch_size of X neurons/types (defaults to 10) through these stages:</p><ul>
<li><p>Phase I - choose which neurons are okay and which need modifying /
are truncated / are unsplittable / have a bad soma, etc.</p></li>
<li><p>Phase II - manually edit those neurons that need modifying. Top tip:
You can ‘cycle’ through branches and update them to a certain cable type one
at a time. This works by removing the primary neurite and linker,
so it is good to define these first for a neuron, and then cycle
through branches as a quick way to assign axon/dendrite.</p></li>
<li><p>Phase III - Review manually modified neurons.</p></li>
</ul><p>Video tutorial: <a href='https://drive.google.com/open?id=1FB7m1QFKApysO74maHAx-yg2CQWkx49C'>https://drive.google.com/open?id=1FB7m1QFKApysO74maHAx-yg2CQWkx49C</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Assign mPN review to Nik Drummond (ND)</span>
<span class='fu'>hemibrain_task_update</span>(<span class='kw'>bodyids</span> <span class='kw'>=</span> <span class='no'>mpn.ids</span>, <span class='kw'>column</span> <span class='kw'>=</span> <span class='st'>"user"</span>, <span class='kw'>update</span> <span class='kw'>=</span> <span class='st'>"ND"</span>)
}<span class='co'># }</span>
<span class='co'># \donttest{</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'># Plot splits to check them, correcting any errors, and saving your changes</span>
<span class='kw pkg'>nat</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/nat/man/nopen3d.html'>nopen3d</a></span>()
<span class='fu'>hemibrain_adjust_saved_split</span>()

<span class='co'># In order to read neurons more quickly from a local source / Google Drive</span>
<span class='no'>db</span> <span class='kw'>=</span> <span class='fu'><a href='hemibrain_read_neurons.html'>hemibrain_neurons</a></span>()
<span class='kw pkg'>nat</span><span class='kw ns'>::</span><span class='fu'><a href='https://rdrr.io/pkg/nat/man/nopen3d.html'>nopen3d</a></span>()
<span class='fu'>hemibrain_adjust_saved_split</span>(<span class='kw'>db</span><span class='kw'>=</span><span class='no'>db</span>)
}<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Alexander Bates, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


