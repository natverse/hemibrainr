<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Code for Working with Data from Janelia FlyEM's Hemibrain Project`` • hemibrainr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Code for Working with Data from Janelia FlyEM's Hemibrain Project``">
<meta property="og:description" content="Useful functions for pre-processing and analysing data from Janelia FlyEM's hemibrain project &lt;https://www.janelia.org/project-team/flyem/hemibrain&gt;. 
             Data can be accessed from a neuPrint instance &lt;https://neuprint.janelia.org/&gt; using the R package neuprintr.">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">hemibrainr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/flywire.html">flywire</a>
    </li>
    <li>
      <a href="articles/glomerulus_search.html">glomerulus search</a>
    </li>
    <li>
      <a href="articles/google_filestream.html">read data from Google drive</a>
    </li>
    <li>
      <a href="articles/hemibrain_alpns_toons.html">olfactory connectivity</a>
    </li>
    <li>
      <a href="articles/hemibrain_axons_dendrites.html">axons and dendrites</a>
    </li>
    <li>
      <a href="articles/hemibrain_connectivity.html">hemibrain connectivity</a>
    </li>
    <li>
      <a href="articles/match_making.html">neuron match making</a>
    </li>
    <li>
      <a href="articles/meta_data.html">hemibrain and flywire meta data</a>
    </li>
    <li>
      <a href="articles/packages_guide.html">related packages</a>
    </li>
    <li>
      <a href="articles/transmitters.html">transmitters</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/flyconnectome/hemibrainr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<p><img src="reference/figures/logo.svg" align="right" height="139"><!-- badges: start --><a href="https://github.com/natverse/hemibrainr/actions"><img src="https://github.com/natverse/hemibrainr/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a> <a href="https://codecov.io/gh/natverse/hemibrainr?branch=master"><img src="https://codecov.io/gh/natverse/hemibrainr/branch/master/graph/badge.svg" alt="Codecov test coverage"></a> <a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a> <!-- badges: end --></p>
<div id="hemibrainr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#hemibrainr" class="anchor"></a>hemibrainr</h1></div>
<p>The goal of <em>hemibrainr</em> is to provide useful code for preprocessing and analysing data from the <a href="https://www.janelia.org/project-team/flyem">Janelia FlyEM hemibrain</a> project. It makes use of the <a href="https://github.com/natverse">natverse</a> R package, <a href="https://github.com/natverse/neuprintr">neuprintr</a> to get hemibrain data from their connectome analysis and data hosting service <a href="https://github.com/connectome-neuprint/neuPrint">neuprint</a>. The dataset has been described <a href="(https://www.biorxiv.org/content/10.1101/2020.01.21.911859v1)">here</a>. Using this R package in concert with the <a href="https://github.com/natverse/natverse">natverse</a> ecosystem is highly recommended.</p>
<p>The hemibrain connectome comprises the region of the fly brain depicted below. It is ~21,662 ~full neurons, 9.5 million synapses and is about ~35% complete in this region:</p>
<center>
<p><img src="https://raw.githubusercontent.com/natverse/hemibrainr/master/inst/images/hemibrain.png" alt="hemibrain"></p>
</center>
<div id="get-started-with-hemibrainr" class="section level2">
<h2 class="hasAnchor">
<a href="#get-started-with-hemibrainr" class="anchor"></a>Get started with hemibrainr</h2>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org">"remotes"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"natverse/hemibrainr"</span><span class="op">)</span>

<span class="co"># use </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/flyconnectome/hemibrainr">hemibrainr</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="using-hemibrainr" class="section level3">
<h3 class="hasAnchor">
<a href="#using-hemibrainr" class="anchor"></a>Using hemibrainr</h3>
<p><em>hemibrainr</em> contains tools with which to quickly work with <a href="https://neuprint.janelia.org/help/videos?dataset=hemibrain">hemibrain</a> and <a href="https://ngl.flywire.ai/?local_id=c8c06ea181ad5447b04beacfc4cb1b66">FlyWire</a> neurons, and match up neurons within and between data sets.</p>
<p>If you can connect to the <em>hemibrainr</em> google shared drive, this package puts thousands of hemibrain and FlyWire neurons at your fingertips, as well as information on their compartments (e.g. axons versus dendrites), synapses and connectivity and between data set neuron-neuron matches. You can:</p>
<ul>
<li>Read thousands of pre-skeletonised FlyWire/hemibrain neurons from Google Drive</li>
<li>Read FlyWire/hemibrain NBLASTs and NBLASTs to hemibrain neurons</li>
<li>Read FlyWire/hemibrain neurons that are pre-transformed into a variety of brainspaces</li>
</ul>
<p>Which is all useful stuff. You can explore our articles for more detailed information on what the package can do, and how to set it up with the data stored on Google drive - but can take a quick tour here:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/flyconnectome/hemibrainr">hemibrainr</a></span><span class="op">)</span>

<span class="co"># Else, it wants to see it on the mounted team drive, here</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"remote_connectome_data"</span><span class="op">)</span>

<span class="co"># We can load meta data for all neurons in hemibrain</span>
<span class="va">db</span> <span class="op">=</span> <span class="fu"><a href="reference/hemibrain_read_neurons.html">hemibrain_neurons</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># And quickly read them from the drive, when we try to plot/analyse them!</span>
<span class="fu"><a href="reference/hemibrain_view.html">hemibrain_view</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu">plot3d</span><span class="op">(</span><span class="va">hemibrain.surf</span>, col <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="fu">plot3d</span><span class="op">(</span><span class="va">db</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<p>See which neurons have been matched up:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># See matches, you can do this without hemibrain Google Team Drive access</span>
<span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">hemibrain_matched</span><span class="op">)</span>

<span class="co"># Get fresh matches, you cannot do this without access</span>
<span class="co">## You will be prompted to log-in through your browser</span>
<span class="va">hemibrain_matched_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/hemibrain_matches.html">hemibrain_matches</a></span><span class="op">(</span><span class="op">)</span> 
<span class="co">## NOTE: includes hemibrain&lt;-&gt;FlyWire matches!</span></code></pre></div>
</div>
<div id="neuprint-authentication" class="section level3">
<h3 class="hasAnchor">
<a href="#neuprint-authentication" class="anchor"></a>neuPrint authentication</h3>
<p>In order to use <em>neuprintr</em>, which fetches data we want to use with <em>hemibrainr</em>, you will need to be able to login to a neuPrint server and be able to access it underlying Neo4j database.</p>
<p>You may need an authenticated accounted, or you may be able to register your <code>@gmail</code> address without an authentication process. Navigate to a neuPrint website, e.g. <a href="https://neuprint.janelia.org" class="uri">https://neuprint.janelia.org</a>, and hit ‘login’. Sign in using an <code>@gmail</code> account. If you have authentication/the server is public, you will now be able to see your access token by going to ‘Account’:</p>
<p><img src="https://raw.githubusercontent.com/natverse/neuprintr/master/inst/images/bearertoken.png" alt="access your bearer token"></p>
<p>To make life easier, you can then edit your <code>.Renviron</code> file to contain information about the neuPrint server you want to speak with, your token and the dataset hosted by that server, that you want to read. A convenient way to do this is to do</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">usethis</span><span class="fu">::</span><span class="fu"><a href="https://usethis.r-lib.org/reference/edit.html">edit_r_environ</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>and then edit the file that pops up, adding a section like</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">neuprint_server</span><span class="op">=</span><span class="st">"https://neuprint.janelia.org"</span>
<span class="co"># nb this token is a dummy</span>
<span class="va">neuprint_token</span><span class="op">=</span><span class="st">"asBatEsiOIJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImIsImxldmVsIjoicmVhZHdyaXRlIiwiaW1hZ2UtdXJsIjoiaHR0cHM7Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1QeFVrTFZtbHdmcy9BQUFBQUFBQUFBDD9BQUFBQUFBQUFBQS9BQ0hpM3JleFZMeEI4Nl9FT1asb0dyMnV0QjJBcFJSZlI6MTczMjc1MjU2HH0.jhh1nMDBPl5A1HYKcszXM518NZeAhZG9jKy3hzVOWEU"</span></code></pre></div>
<p>Make sure you have a blank line at the end of your <code>.Renviron</code> file. For further information try about neuprintr login, see the help for <code>neuprint_login()</code>.</p>
<p>Finally you can also login on the command line once per session, like so:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">conn</span> <span class="op">=</span> <span class="fu">neuprintr</span><span class="fu">::</span><span class="fu"><a href="https://natverse.org/neuprintr/reference/neuprint_login.html">neuprint_login</a></span><span class="op">(</span>server<span class="op">=</span> <span class="st">"https://neuprint.janelia.org/"</span>,
   token<span class="op">=</span> <span class="st">"asBatEsiOIJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImIsImxldmVsIjoicmVhZHdyaXRlIiwiaW1hZ2UtdXJsIjoiaHR0cHM7Ly9saDQuZ29vZ2xldXNlcmNvbnRlbnQuY29tLy1QeFVrTFZtbHdmcy9BQUFBQUFBQUFBDD9BQUFBQUFBQUFBQS9BQ0hpM3JleFZMeEI4Nl9FT1asb0dyMnV0QjJBcFJSZlI6MTczMjc1MjU2HH0.jhh1nMDBPl5A1HYKcszXM518NZeAhZG9jKy3hzVOWEU"</span><span class="op">)</span></code></pre></div>
<p>This is also the approach that you would take if you were working with more than two neuPrint servers.</p>
</div>
<div id="connect-to-hemibrainr-google-team-drive" class="section level3">
<h3 class="hasAnchor">
<a href="#connect-to-hemibrainr-google-team-drive" class="anchor"></a>Connect to hemibrainr Google team drive</h3>
<p>For this, you need access to th hemibrainr google team drive. Authentication is through an email account. Once you have access, there are two basic ways to mount the data for use:</p>
<p>Option 1, mount your Google drives using <a href="https://support.google.com/a/answer/7491144?hl=en">Google filestream</a>. However, for this to work you will need <a href="https://workspace.google.com/pricing.html">Google Workspace</a>, Google’s monthly subscription offering for businesses and organizations. One the <a href="https://support.google.com/a/answer/7491144?hl=en">Google filestream</a> application is run, you should be able to see your drives mounted like external hard drive, as so:</p>
<center>
<img src="https://raw.githubusercontent.com/natverse/hemibrainr/master/inst/images/google_filestream.png" title="fig:" alt="google_filestream">
</center>
<p>Then, this should work:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Set a new Google drive, can be the team drive name or a path to the correct drive</span>
<span class="fu"><a href="reference/hemibrainr_set_drive.html">hemibrainr_set_drive</a></span><span class="op">(</span><span class="st">"hemibrainr"</span><span class="op">)</span> <span class="co"># No need to run this each time though, this is the default. Use if you want to use a different name drive.</span>

<span class="co"># Now just get the name of your default team drive.</span>
<span class="co">## This will be used to locate your team drive using the R package googledrive</span>
<span class="fu"><a href="reference/hemibrainr_set_drive.html">hemibrainr_team_drive</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>Option 2, this is free. You still need authenticated access to the hemibrainr Gogle team drive. It can then be mounted using <a href="https://rclone.org/">rclone</a>. First, <a href="https://rclone.org/downloads/">download</a> rclone for your operating system. You can also download from your system’s command line (e.g. from terminal) and then configure it for the drive:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># unix/macosx</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> https://rclone.org/install.sh <span class="kw">|</span> <span class="fu">sudo</span> bash</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="ex">rclone</span> config</span></code></pre></div>
<p>And now check this has worked:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># mounts in working directory</span>
<span class="fu"><a href="reference/hemibrainr_set_drive.html">hemibrainr_rclone</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># Now hemibrain neurons are read from this mount</span>
<span class="va">db</span> <span class="op">=</span> <span class="fu"><a href="reference/hemibrain_read_neurons.html">hemibrain_neurons</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># read from the google drive</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span>
<span class="fu">plot3d</span><span class="op">(</span><span class="va">hemibrain_neurons</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span>

<span class="co"># Specifically, from here</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"remote_connectome_data"</span><span class="op">)</span>

<span class="co"># unmounts</span>
<span class="fu"><a href="reference/hemibrainr_set_drive.html">hemibrainr_rclone_unmount</a></span><span class="op">(</span><span class="op">)</span>

<span class="co"># And now we are back to:</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html">options</a></span><span class="op">(</span><span class="st">"remote_connectome_data"</span><span class="op">)</span></code></pre></div>
<p>For more detailed instructions, see <a href="https://natverse.github.io/hemibrainr/articles/google_filestream.html">this article</a>.</p>
</div>
<div id="example-splitting-neurons" class="section level3">
<h3 class="hasAnchor">
<a href="#example-splitting-neurons" class="anchor"></a>Example: ‘splitting’ neurons</h3>
<p>Let’s get started with a useful function for splitting a neuron into its axon and dendrite:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Choose neurons</span>
<span class="co">## These neurons are some 'tough' examples from the hemibrain:v1.0.1</span>
<span class="co">### They will split differently depending on the parameters you use.</span>
<span class="va">tough</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"5813056323"</span>, <span class="st">"579912201"</span>, <span class="st">"5813015982"</span>, <span class="st">"973765182"</span>, <span class="st">"885788485"</span>,
<span class="st">"915451074"</span>, <span class="st">"5813032740"</span>, <span class="st">"1006854683"</span>, <span class="st">"5813013913"</span>, <span class="st">"5813020138"</span>,
<span class="st">"853726809"</span>, <span class="st">"916828438"</span>, <span class="st">"5813078494"</span>, <span class="st">"420956527"</span>, <span class="st">"486116439"</span>,
<span class="st">"573329873"</span>, <span class="st">"5813010494"</span>, <span class="st">"5813040095"</span>, <span class="st">"514396940"</span>, <span class="st">"665747387"</span>,
<span class="st">"793702856"</span>, <span class="st">"451644891"</span>, <span class="st">"482002701"</span>, <span class="st">"391631218"</span>, <span class="st">"390948259"</span>,
<span class="st">"390948580"</span>, <span class="st">"452677169"</span>, <span class="st">"511262901"</span>, <span class="st">"422311625"</span>, <span class="st">"451987038"</span>
<span class="op">)</span>

<span class="co"># Get neurons</span>
<span class="va">neurons</span> <span class="op">=</span> <span class="fu">neuprint_read_neurons</span><span class="op">(</span><span class="va">tough</span><span class="op">)</span>

<span class="co"># Now make sure the neurons have a soma marked</span>
<span class="co">## Some hemibrain neurons do not, as the soma was chopped off</span>
<span class="va">neurons.checked</span> <span class="op">=</span> <span class="fu"><a href="reference/hemibrain_skeleton_check.html">hemibrain_skeleton_check</a></span><span class="op">(</span><span class="va">neurons</span>, meshes <span class="op">=</span> <span class="va">hemibrain.rois</span><span class="op">)</span>

<span class="co"># Split neuron</span>
<span class="co">## These are the recommended parameters for hemibrain neurons</span>
<span class="va">neurons.flow</span> <span class="op">=</span> <span class="fu"><a href="reference/flow_centrality.html">flow_centrality</a></span><span class="op">(</span><span class="va">neurons.checked</span>, polypre <span class="op">=</span> <span class="cn">TRUE</span>,
mode <span class="op">=</span> <span class="st">"centrifugal"</span>,
split <span class="op">=</span> <span class="st">"distance"</span><span class="op">)</span>

<span class="co"># Plot the split to check it</span>
<span class="fu">nat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html">nopen3d</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="reference/plot3d_split.html">nlscan_split</a></span><span class="op">(</span><span class="va">neurons.flow</span>, WithConnectors <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div id="data-fields" class="section level2">
<h2 class="hasAnchor">
<a href="#data-fields" class="anchor"></a>Data fields</h2>
<p>Here are some of the most useful column entries across these data. Please let me know if I have missed something important:</p>
<table class="table">
<colgroup>
<col width="11%">
<col width="81%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th>column</th>
<th>description</th>
<th>data entity</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>flywire.xyz</td>
<td>A cardinal point in raw FlyWire voxel space that defines a neuron</td>
<td>many</td>
</tr>
<tr class="even">
<td>flywire.id</td>
<td>The unique 16 digit ID for the flywire neuron, changes when neuron edited</td>
<td>many</td>
</tr>
<tr class="odd">
<td>flywire.svid</td>
<td>The supervoxel ID that corresponds to flywire.xyz</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>cell.type</td>
<td>If neuron matched to a hemibrain neuron we get its cell type</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>side</td>
<td>The hemisphere of the brain that the neuron’s soma, or else root-point, is thought to be on</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>status</td>
<td>A manually assigned ‘status’ from a Drosophila Connectomics Group tracer, indicating the quality of the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>skid</td>
<td>The neuron’s skeleton ID in CATMAID, if it exists. The CATMAID neuron may have manualyl annotated synapses</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>FAFB.xyz</td>
<td>A cardinal point in FAFB14 voxel space that defines a neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>ItoLee_Hemilineage</td>
<td>A meaningful biological category, the developmental hemilineage to which we think the neuron belongs, in the nomenclature of Ito et al. 2013</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>ItoLee_Lineage</td>
<td>A meaningful biological category, the developmental lineage (comprises multiple hemilineages) to which we think the neuron belongs, in the nomenclature of Ito et al. 2013</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>Hartenstein_Hemilineage</td>
<td>A meaningful biological category, the developmental hemilineage to which we think the neuron belongs, in the nomenclature of Lovick/Wong et al. 2013, can be matched to similar names in the larval animal</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>Hartenstein_Lineage</td>
<td>A meaningful biological category, the developmental (comprises multiple hemilineages) to which we think the neuron belongs, in the nomenclature of Lovick/Wong et al. 2013, can be matched to similar names in the larval animal</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>gsheet</td>
<td>A Drosophila Connectomics Group googlesheet on which the flywire.id ID is recorded</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>hemibrain.match</td>
<td>A semi-manually matched hemibrain neuron’s bodyID</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>hemibrain.match.quality</td>
<td>A manually assigned quality for the hemibrain match</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>FAFB.hemisphere.match</td>
<td>A cardinal point for a neuron on the other hemisphere that has semi-manually been found to match the given neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>FAFB.hemisphere.match.quality</td>
<td>A manually assigned quality for the FAFB hemisphere match</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>dataset</td>
<td>The dataset to which the given neuron belongs</td>
<td>hemibrain_matches</td>
</tr>
<tr class="odd">
<td>total.outputs</td>
<td>The total number of output links / postsynapses from the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>axon.outputs</td>
<td>The total number of axonal output links / postsynapses from the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>dend.outputs</td>
<td>The total number of dendritic output links / postsynapses from the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>total.outputs.density</td>
<td>The total number of output links / postsynapses from the neuron, per micron of cable</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>axon.outputs.density</td>
<td>The total number of axonal links / postsynapses from the neuron, per micron of cable</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>dend.outputs.density</td>
<td>The total number of dendritic links / postsynapses from the neuron, per micron of cable</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>total.outputs</td>
<td>The total number of input links / postsynapses from the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>axon.inputs</td>
<td>The total number of axonal input links / postsynapses from the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>dend.inputs</td>
<td>The total number of dendritic input links / postsynapses from the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>total.inputs.density</td>
<td>The total number of input links / postsynapses from the neuron, per micron of cable</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>axon.inputs.density</td>
<td>The total number of axonal links / postsynapses from the neuron, per micron of cable</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>dend.inputs.density</td>
<td>The total number of dendritic links / postsynapses from the neuron, per micron of cable</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>total.length</td>
<td>The total cable length, in microns, for the neuron A cardinal point in raw FlyWire voxel space that defines a neuro</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>axon.length</td>
<td>The axonal cable length, in microns, for the neuron A cardinal point in raw FlyWire voxel space that defines a neuro</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>dend.length</td>
<td>The dendritic cable length, in microns, for the neuron A cardinal point in raw FlyWire voxel space that defines a neuro</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>pd.length</td>
<td>The primary dendrite (linker) cable length, in microns, for the neuron A cardinal point in raw FlyWire voxel space that defines a neuro</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>pnt.length</td>
<td>The primary neurite (cell body fibre) cable length, in microns, for the neuron A cardinal point in raw FlyWire voxel space that defines a neuro</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>segregation_index</td>
<td>An entropy score for how segregated the neuron’s synapses are into axon and dendrite, see Schneider-Mizell et al 2016, eLife</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>root</td>
<td>The treenode ID (position in .swc file) of the neuron’s root</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>nodes</td>
<td>The number of nodes in the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>segments</td>
<td>The number of segments in the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>banchpoints</td>
<td>The number of banchpoints in the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>endpoints</td>
<td>The number of endpoints in the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>nTrees</td>
<td>The number of trees in the neuron, should be 1</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>connectors</td>
<td>The number of synapses in the neuron</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>postsynapse_side_index</td>
<td>Side side of the neuron that receives the most input, calculated as: (no. postsynaptic links on right - no. on left)/total</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>presynapse_side_index</td>
<td>Side side of the neuron that receives the most output, calculated as: (no. presynaptic links on right - no. on left)/total</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>axon_postsynapse_side_index</td>
<td>Same as postsynapse_side_index, but only for the axon</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>axon_presynapse_side_index</td>
<td>Same as presynapse_side_index, but only for the axon</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>dendrite_postsynapse_side_index</td>
<td>Same as postsynapse_side_index, but only for the dendrite</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>dendrite_presynapse_side_index</td>
<td>Same as presynapse_side_index, but only for the dendrite</td>
<td>flywire_meta</td>
</tr>
<tr class="even">
<td>top.nt</td>
<td>The most prominent predicted transmitter for the neurons’ presynpses (the modal across all presynaptic links for: the best nt prediction for each synapses above cleft_score of 50)</td>
<td>flywire_meta</td>
</tr>
<tr class="odd">
<td>offset</td>
<td>The index for the Buhmann synapse in the original .sql table</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>x,y,z</td>
<td>The position of the connection in FlyWire space</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>scores</td>
<td>The Buhmamnn prediction score for the synapse, unsure definition</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>top.p</td>
<td>The probability of the top transmitter prediction for the presynaptic end of this connection</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>top.nt</td>
<td>The top transmitter prediction for the presynaptic end of this connection</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>gaba</td>
<td>The synister prediction score for gaba</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>glutamate</td>
<td>The synister prediction score for glutamate</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>acetylcholine</td>
<td>The synister prediction score for acetylcholine</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>octopamine</td>
<td>The synister prediction score for octopamine</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>serotonin</td>
<td>The synister prediction score for serotonin</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>dopamine</td>
<td>The synister prediction score for dopamine</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>prepost</td>
<td>Whether the synapse is pre- (0, i.e. output synapse) orr post (1, i.e. input)</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>segmentid_pre</td>
<td>The segment (?) for the presynaptic side of the link</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>segmentid_pre</td>
<td>The segment (?) for the postsynaptic side of the link</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>pre_svid</td>
<td>The flywire supervoxel ID for the presynaptic side of the link</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>post_svid</td>
<td>The flywire supervoxel ID for the postsynaptic side of the link</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>pre_id</td>
<td>The flywire.id for the presynaptic side of the link</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>post_id</td>
<td>The flywire.id for the postsynaptic side of the link</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>treenode_id</td>
<td>The treenode in the corresponding swc/d to which this synapse is best attached</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>strahler_order</td>
<td>The strahler order of the branch on which the synapse is positioned</td>
<td>connectors</td>
</tr>
<tr class="odd">
<td>Label</td>
<td>The comparment of the neuron on which the synapse is positioned, 2 = axon, 3 - dendrite, 4 = primary.dendrite, 7 = primary.neurite, 1 = soma</td>
<td>connectors</td>
</tr>
<tr class="even">
<td>PointNo</td>
<td>The ID for each point in the neuron</td>
<td>swc/d</td>
</tr>
<tr class="odd">
<td>X,Y,Z</td>
<td>The FlyWire coordinate of the point</td>
<td>swc/d</td>
</tr>
<tr class="even">
<td>W</td>
<td>The width of the point, generally not used</td>
<td>swc/d</td>
</tr>
<tr class="odd">
<td>parent</td>
<td>The Parent node, -1 means root</td>
<td>swc/d</td>
</tr>
<tr class="even">
<td>post</td>
<td>The number of postsynapses attachec to node</td>
<td>swc/d</td>
</tr>
<tr class="odd">
<td>pre</td>
<td>The Pnumberf of presynapses attached to node</td>
<td>swc/d</td>
</tr>
<tr class="even">
<td>flow.cent</td>
<td>The synaptic flow at this node, see Schneider-Mizell et al. 2016</td>
<td>swc/d</td>
</tr>
<tr class="odd">
<td>strahler_order</td>
<td>The strahler order of this node</td>
<td>swc/d</td>
</tr>
</tbody>
</table>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>Data</h2>
<ul>
<li>HemiBrain (hemibrain:v1.0) : from <a href="https://www.biorxiv.org/content/10.1101/2020.01.21.911859v1">“A Connectome of the Adult Drosophila Central Brain”</a> (Xu, et al. 2020)</li>
</ul>
</div>
<div id="acknowledging-the-tools" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledging-the-tools" class="anchor"></a>Acknowledging the tools</h2>
<p>neuPrint comprises a set of tools for loading and analyzing connectome data into a Neo4j database. Analyze and explore connectome data stored in Neo4j using the neuPrint ecosystem: <a href="https://github.com/connectome-neuprint/neuPrintHTTP">neuPrintHTTP</a>, <a href="https://github.com/connectome-neuprint/neuPrintExplorer">neuPrintExplorer</a>, <a href="https://github.com/connectome-neuprint/neuprint-python">Python API</a>.</p>
<p>This package was created by <a href="https://scholar.google.com/citations?user=BOVTiXIAAAAJ&amp;hl=en">Alexander Shakeel Bates</a> and <a href="https://en.wikipedia.org/wiki/Gregory_Jefferis">Gregory Jefferis</a>. You can cite this package as:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html">citation</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"hemibrainr"</span><span class="op">)</span></code></pre></div>
<p><strong>Bates AS, Jefferis GSXE</strong> (2020). <em>hemibrainr: Code for working with data from Janelia FlyEM’s hemibrain project.</em> <strong>R package</strong> version 0.1.0. <a href="https://github.com/natverse/hemibrainr" class="uri">https://github.com/natverse/hemibrainr</a></p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/flyconnectome/hemibrainr/">https://​github.com/​flyconnectome/​hemibrainr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/flyconnectome/hemibrainr/issues">https://​github.com/​flyconnectome/​hemibrainr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Alexander Bates <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-1195-0445" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Gregory Jefferis <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-0587-9355" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Alexander Bates, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
