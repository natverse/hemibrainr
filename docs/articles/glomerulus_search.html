<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>glomerulus search â€¢ hemibrainr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="glomerulus search">
<meta property="og:description" content="hemibrainr">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hemibrainr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/flywire.html">flywire</a>
    </li>
    <li>
      <a href="../articles/glomerulus_search.html">glomerulus search</a>
    </li>
    <li>
      <a href="../articles/google_filestream.html">read data from Google drive</a>
    </li>
    <li>
      <a href="../articles/hemibrain_alpns_toons.html">olfactory connectivity</a>
    </li>
    <li>
      <a href="../articles/hemibrain_axons_dendrites.html">axons and dendrites</a>
    </li>
    <li>
      <a href="../articles/hemibrain_connectivity.html">hemibrain connectivity</a>
    </li>
    <li>
      <a href="../articles/match_making.html">neuron match making</a>
    </li>
    <li>
      <a href="../articles/meta_data.html">hemibrain and flywire meta data</a>
    </li>
    <li>
      <a href="../articles/packages_guide.html">related packages</a>
    </li>
    <li>
      <a href="../articles/transmitters.html">transmitters</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/flyconnectome/hemibrainr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="glomerulus_search_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>glomerulus search</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/flyconnectome/hemibrainr/blob/master/vignettes/glomerulus_search.Rmd"><code>vignettes/glomerulus_search.Rmd</code></a></small>
      <div class="hidden name"><code>glomerulus_search.Rmd</code></div>

    </div>

    
    
<p>Here, our aim is to get the DM6 uniglomerular projection neuron, and obtain all of its synapses within the DM6 glomerulus. We then want to find all the partner neurons that connect with it, both up- and downstream, within that glomerulus.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load the libraries we need</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/flyconnectome/hemibrainr">hemibrainr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/fafbseg">fafbseg</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/natverse/elmr">elmr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jokergoo/ComplexHeatmap">ComplexHeatmap</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/choose_segmentation.html">choose_segmentation</a></span><span class="op">(</span><span class="st">'flywire'</span><span class="op">)</span>

<span class="co"># We need to use some python modules to skeletonise meshes</span>
<span class="co">## Install them with this R code</span>
<span class="co"># fafbseg::simple_python("full")</span>

<span class="co"># We can query the virtual fly brain public CATMAID in order to obtain</span>
<span class="co"># A CATMAID reconstruction of the DM6 uPN, and so find its flywire equivalent.</span>
<span class="va">adult.conn</span> <span class="op">=</span> <span class="fu">catmaid_login</span><span class="op">(</span>server<span class="op">=</span><span class="st">"https://catmaid-fafb.virtualflybrain.org/"</span><span class="op">)</span>
<span class="va">dm6.upn.ids.all</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/fafb14_to_flywire_ids.html">fafb14_to_flywire_ids</a></span><span class="op">(</span><span class="st">"name:Uniglomerular mALT DM6 adPN"</span><span class="op">)</span>
<span class="co">### Includes both left and right uPNs</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># You can now look at all fo the IDs in flywire, and connect </span>
<span class="co"># Them up if needed. Some will be wrong. Look at the hits column, probably</span>
<span class="co"># Best to just look through things with high hits.</span>

<span class="co"># This now gives you one flywire ID per neuron</span>
<span class="va">dm6.upn.ids.biggest</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/fafb14_to_flywire_ids.html">fafb14_to_flywire_ids</a></span><span class="op">(</span><span class="st">"name:Uniglomerular mALT DM6 adPN"</span>,
                                        only.biggest <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">dm6.upn.ids</span> <span class="op">=</span> <span class="va">dm6.upn.ids.biggest</span><span class="op">$</span><span class="va">root_id</span>

<span class="co"># Get meshes</span>
<span class="va">dm6.upn.meshes</span> <span class="op">=</span> <span class="fu">fafbseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/read_cloudvolume_meshes.html">read_cloudvolume_meshes</a></span><span class="op">(</span><span class="va">dm6.upn.ids</span><span class="op">)</span>

<span class="co"># Look good?</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html">nopen3d</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">dm6.upn.meshes</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">FAFB14</span>, col <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let us get the skeletons </span>
<span class="va">dm6.upn.skels</span> <span class="op">=</span> <span class="fu">fafbseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/skeletor.html">skeletor</a></span><span class="op">(</span><span class="va">dm6.upn.ids</span>, method <span class="op">=</span> <span class="st">'wavefront'</span><span class="op">)</span>
<span class="co">### If this crashes, follow these instructions instead: http://natverse.org/fafbseg/articles/articles/installing-cloudvolume-meshparty.html</span>
<span class="co">### Or cheat and just get the skeletons from the drive:  dm6.upn.skels = subset(flywire_neurons(), root_id %in% dm6.upn.ids)</span>

<span class="co"># Look good?</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html">nopen3d</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">dm6.upn.skels</span>, lwd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">FAFB14</span>, col <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<center>
<img src="https://raw.githubusercontent.com/natverse/hemibrainr/master/inst/images/dm6.skeletonisation.png" title="fig:" alt="dm6.skeletonisation">
</center>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Now let us attach the synapses with prediction</span>
<span class="va">dm6.upn.syn</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/flywire_neurons_add_synapses.html">flywire_neurons_add_synapses</a></span><span class="op">(</span><span class="va">dm6.upn.skels</span>,
                                        cleft.threshold <span class="op">=</span> <span class="fl">50</span>,
                                        transmitters <span class="op">=</span> <span class="cn">FALSE</span>,
                                        Verbose <span class="op">=</span> <span class="cn">TRUE</span>,
                                        OmitFailures <span class="op">=</span> <span class="cn">TRUE</span>,
                                        .parallel <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Now split into axon and dendrite</span>
<span class="va">dm6.upn.flow</span> <span class="op">=</span> <span class="fu">hemibrainr</span><span class="fu">::</span><span class="fu"><a href="../reference/flow_centrality.html">flow_centrality</a></span><span class="op">(</span><span class="va">dm6.upn.syn</span>, mode <span class="op">=</span> <span class="st">"centrifugal"</span>, polypre <span class="op">=</span> <span class="cn">TRUE</span>, split <span class="op">=</span> <span class="st">"synapses"</span>, .parallel <span class="op">=</span> <span class="cn">FALSE</span>, OmitFailures <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Plot together</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html">nopen3d</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">FAFB14</span>, col <span class="op">=</span> <span class="st">"grey"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot3d_split.html">plot3d_split</a></span><span class="op">(</span><span class="va">dm6.upn.flow</span><span class="op">)</span></code></pre></div>
<center>
<img src="https://raw.githubusercontent.com/natverse/hemibrainr/master/inst/images/dm6.split.png" title="fig:" alt="dm6.split">
</center>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get synapse data</span>
<span class="va">dm6.upn.synapses</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_extract_synapses.html">hemibrain_extract_synapses</a></span><span class="op">(</span><span class="va">dm6.upn.flow</span>, .parallel <span class="op">=</span> <span class="cn">FALSE</span>, OmitFailures <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># Obtain partner neurons, but only at the dendrite</span>
<span class="va">dm6.upn.synapses.dend</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">dm6.upn.synapses</span>, <span class="va">Label</span> <span class="op">==</span> <span class="st">"dendrite"</span><span class="op">)</span>
<span class="va">dm6.upn.synapses.dend</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">dm6.upn.synapses.dend</span>, <span class="va">y</span> <span class="op">&gt;</span> <span class="fl">175000</span><span class="op">)</span>

<span class="co"># See the DM6 glomerulus</span>
<span class="va">dm6</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">flywire_al.surf</span>, <span class="st">'DM6'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html">nopen3d</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">FAFB14</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">dm6</span>, col <span class="op">=</span> <span class="va">hemibrain_bright_colors</span><span class="op">[</span><span class="st">"cerise"</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>
<span class="fu">points3d</span><span class="op">(</span><span class="fu">nat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/xyzmatrix.html">xyzmatrix</a></span><span class="op">(</span><span class="va">dm6.upn.synapses.dend</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">hemibrain_bright_colors</span><span class="op">[</span><span class="st">"marine"</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<center>
<img src="https://raw.githubusercontent.com/natverse/hemibrainr/master/inst/images/dm6.synapses.png" title="fig:" alt="dm6.synapses">
</center>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get connections in an edgelist</span>
<span class="va">dm6.upn.conns</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_extract_synapses.html">hemibrain_extract_connections</a></span><span class="op">(</span><span class="va">dm6.upn.synapses.dend</span><span class="op">)</span>
<span class="va">dm6.upn.conns.strong</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">dm6.upn.conns</span>, <span class="va">count</span> <span class="op">&gt;=</span> <span class="fl">10</span><span class="op">)</span>
<span class="va">dm6.upn.partner.ids</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="va">dm6.upn.conns.strong</span><span class="op">$</span><span class="va">partner</span><span class="op">)</span><span class="op">)</span>
<span class="va">dm6.upn.partner.skels</span> <span class="op">=</span> <span class="fu">fafbseg</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/fafbseg/man/skeletor.html">skeletor</a></span><span class="op">(</span><span class="va">dm6.upn.partner.ids</span>, method <span class="op">=</span> <span class="st">'wavefront'</span><span class="op">)</span>
<span class="co">## These IDs constitute the neurons you should examine and 'clean up' in flywire</span>

<span class="co"># Treat GABA/Glut synapses as inhibitory (if you have the predicted transmitters)</span>
<span class="va">dm6.upn.conns.strong</span><span class="op">$</span><span class="va">count</span><span class="op">[</span><span class="va">dm6.upn.conns.strong</span><span class="op">$</span><span class="va">top_nt</span><span class="op">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gaba"</span>,<span class="st">"glutamate"</span><span class="op">)</span><span class="op">]</span> <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="va">dm6.upn.conns.strong</span><span class="op">$</span><span class="va">count</span><span class="op">[</span><span class="va">dm6.upn.conns.strong</span><span class="op">$</span><span class="va">top_nt</span><span class="op">%in%</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gaba"</span>,<span class="st">"glutamate"</span><span class="op">)</span><span class="op">]</span>

<span class="co"># Plot!</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html">nopen3d</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">FAFB14</span>, alpha <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">dm6.upn.partner.skels</span>, soma <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span></code></pre></div>
<center>
<img src="https://raw.githubusercontent.com/natverse/hemibrainr/master/inst/images/dm6.partners.png" title="fig:" alt="dm6.partners">
</center>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get up- and downstream connectivity matrices</span>
<span class="va">dm6.conn.mat.downstream</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html">acast</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">dm6.upn.conns.strong</span>, <span class="va">prepost</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>, 
                 formula <span class="op">=</span> <span class="va">root_id</span> <span class="op">~</span> <span class="va">partner</span>, 
                 fun.aggregate <span class="op">=</span> <span class="va">sum</span>,
                 value.var <span class="op">=</span> <span class="st">"count"</span>,
                 fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">dm6.conn.mat.downstream</span><span class="op">)</span>

<span class="va">dm6.conn.mat.upstream</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/cast.html">acast</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">dm6.upn.conns.strong</span>, <span class="va">prepost</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, 
                 formula <span class="op">=</span> <span class="va">root_id</span> <span class="op">~</span> <span class="va">partner</span>, 
                 fun.aggregate <span class="op">=</span> <span class="va">sum</span>,
                 value.var <span class="op">=</span> <span class="st">"count"</span>,
                 fill <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html">Heatmap</a></span><span class="op">(</span><span class="va">dm6.conn.mat.upstream</span><span class="op">)</span></code></pre></div>
<center>
<img src="https://raw.githubusercontent.com/natverse/hemibrainr/master/inst/images/dm6.connectivity.matrix.png" title="fig:" alt="dm6.connectivity.matrix">
</center>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alexander Bates, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
