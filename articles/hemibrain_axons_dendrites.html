<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>axons and dendrites • hemibrainr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="axons and dendrites">
<meta property="og:description" content="hemibrainr">
<meta property="og:image" content="/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hemibrainr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/data.html">hemibrain and flywire meta data</a>
    </li>
    <li>
      <a href="../articles/flywire.html">flywire</a>
    </li>
    <li>
      <a href="../articles/google_filestream.html">read data from Google drive</a>
    </li>
    <li>
      <a href="../articles/hemibrain_alpns_toons.html">olfactory connectivity</a>
    </li>
    <li>
      <a href="../articles/hemibrain_axons_dendrites.html">axons and dendrites</a>
    </li>
    <li>
      <a href="../articles/hemibrain_connectivity.html">hemibrain connectivity</a>
    </li>
    <li>
      <a href="../articles/match_making.html">neuron match making</a>
    </li>
    <li>
      <a href="../articles/packages_guide.html">related packages</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/flyconnectome/hemibrainr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>axons and dendrites</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/flyconnectome/hemibrainr/blob/master/vignettes/hemibrain_axons_dendrites.Rmd"><code>vignettes/hemibrain_axons_dendrites.Rmd</code></a></small>
      <div class="hidden name"><code>hemibrain_axons_dendrites.Rmd</code></div>

    </div>

    
    
<blockquote>
<p>“This history of civilization proves beyond doubt just how sterile the repeated attempts of metaphysics to guess at nature’ s laws have been. Instead, there is every reason to believe that when the human intellect ignores reality and concentrates within, it can no longer explain the simplest inner workings of life’ s machinery or of the world around us.” (<a href="https://en.wikiquote.org/wiki/Santiago_Ram%C3%B3n_y_Cajal">Santiago Ramón y Cajal</a></p>
</blockquote>
<div id="axons-dendrite-and-other-compartments" class="section level1">
<h1 class="hasAnchor">
<a href="#axons-dendrite-and-other-compartments" class="anchor"></a>Axons, dendrite and other compartments</h1>
<p>The philosophy of <code>hemibrainr</code> is to try and treat axons and dendrites separately, where we can. Generally, the division between axon and dendrite is ignored when people use graph theoretic approach on connectome data, or otherwise build their models. However, dendrite and axons may function differently - we just don’t yet know in insects, how differently.</p>
<p>Other compartments include the ‘primary neurite’ or ‘cell body fibre’ (purple, below) <a href="https://www.sciencedirect.com/science/article/pii/S0896627313011781">(Ito et al., 2014)</a>, the non-synaptic cable that attaches the neuron’s cell body, its ‘soma’ to the rest of the neuron. There is also a ‘primary dendrite’, or ‘linker’ (green, below), which is non-synaptic cable that connects a neuron’s dendrite and axon, through which an action potential presumably travels.</p>
<div id="splitting-a-neuron" class="section level2">
<h2 class="hasAnchor">
<a href="#splitting-a-neuron" class="anchor"></a>Splitting a neuron</h2>
<p>Neurons can be split into a principle input zone, a dendrite, and a principle output zone, an axon. Dendrites tend to be more spindly and axons bulkier, with boutons packed with presynapses, ready to release neurotransmitter.</p>
<center>
<img src="https://raw.githubusercontent.com/flyconnectome/hemibrainr/master/inst/images/neuron_split.png" alt="neuron_split">
</center>
<p>But axons and dendrites are not a totally clear division for most neurons. A neuron may have more than one of each. It may also be more ‘amacrine-like’ and lack this division, though this is less common. Dendrites can have outputs, and axons can have inputs. Axons may connect with axons, even dendrites may input and axon.</p>
<p>However, all fly neurons examined can be split into an axon-like and a dendrite-like compartment <a href="https://elifesciences.org/articles/12059">(Schneider-Mizell et al., 2016)</a>). The density of outputs in the axon is higher than in the dendrite. The density of inputs to the dendrite, are higher than in the axon <a href="https://www.sciencedirect.com/science/article/pii/S0960982220308587">(Bates &amp; Schlegel et al., 2020)</a>). Interestingly, the ‘start’ of a dendrite is almost always closer to the neuron’s cell body than the start of its axon. See our recent data <a href="https://www.sciencedirect.com/science/article/pii/S0960982220308587">(Bates &amp; Schlegel et al., 2020)</a>) for three broad classes of olfactory neuron:</p>
<center>
<img src="https://raw.githubusercontent.com/flyconnectome/hemibrainr/master/inst/images/split_validation.png" alt="split_validation">
</center>
<p>The biophysical impact of axo-axonic connections is unclear – they can have non-intuitive effects depending on the timing of action potentials in connected partners <a href="https://en.wikipedia.org/wiki/Axo-axonic_synapse">(Burrows and Laurent, 1993; Burrows and Matheson, 1994; Cuntz et al., 2007; Haag and Borst, 2004)</a>.</p>
</div>
<div id="splitting-a-neuron-by-flow-centrality" class="section level2">
<h2 class="hasAnchor">
<a href="#splitting-a-neuron-by-flow-centrality" class="anchor"></a>Splitting a neuron by flow centrality</h2>
<p>We can split neurons algorithmically by calculating a neuron’s ‘flow centrality’ <a href="https://elifesciences.org/articles/12059">(Schneider-Mizell et al., 2016)</a>).</p>
<p>From <a href="https://elifesciences.org/articles/12059">(Schneider-Mizell et al., 2016)</a>): &gt; “We use flow centrality for four purposes. First, to split an arbor into axon and dendrite at the maximum centrifugal SFC, which is a preliminary step for computing the segregation index, for expressing all kinds of connectivity edges (e.g. axo-axonic, dendro-dendritic) in the wiring diagram, or for rendering the arbor in 3d with differently colored regions. Second, to quantitatively estimate the cable distance between the axon terminals and dendritic arbor by measuring the amount of cable with the maximum centrifugal SFC value. Third, to measure the cable length of the main dendritic shafts using centripetal SFC, which applies only to insect neurons with at least one output syn- apse in their dendritic arbor. And fourth, to weigh the color of each skeleton node in a 3d view, providing a characteristic signature of the arbor that enables subjective evaluation of its identity.”</p>
<p>Explore their methods for more information.</p>
</div>
</div>
<div id="tutorial" class="section level1">
<h1 class="hasAnchor">
<a href="#tutorial" class="anchor"></a>Tutorial</h1>
<p>First, let us get and load the packages we will need:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="st"><a href="https://remotes.r-lib.org">"remotes"</a></span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"remotes"</span><span class="op">)</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"natverse/hemibrainr"</span><span class="op">)</span>

<span class="co"># use </span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/flyconnectome/hemibrainr">hemibrainr</a></span><span class="op">)</span></code></pre></div>
<div id="split-neurons-from-the-hemibrain" class="section level2">
<h2 class="hasAnchor">
<a href="#split-neurons-from-the-hemibrain" class="anchor"></a>Split neurons from the hemibrain</h2>
<p>Let us examine some third-order olfactory neurons (TONs), which we have stored in <code>hemibrainr</code> as <code><a href="../reference/classed.ids.html">hemibrainr::ton.ids</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Let's examine a random set of tons</span>
<span class="va">ids</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu">hemibrainr</span><span class="fu">::</span><span class="va"><a href="../reference/classed.ids.html">ton.ids</a></span>,<span class="fl">10</span><span class="op">)</span>

<span class="co"># Read neurons from neuprint</span>
<span class="va">neurons</span> <span class="op">=</span> <span class="fu">neuprintr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/neuprintr/man/neuprint_read_neurons.html">neuprint_read_neurons</a></span><span class="op">(</span><span class="va">ids</span><span class="op">)</span>

<span class="co"># Now make sure the neurons have a soma marked</span>
<span class="co">## Some hemibrain neurons do not, as the soma was chopped off</span>
<span class="va">neurons.checked</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_skeleton_check.html">hemibrain_skeleton_check</a></span><span class="op">(</span><span class="va">neurons</span>, meshes <span class="op">=</span> <span class="va">hemibrain.surf</span><span class="op">)</span>

<span class="co"># Split neuron</span>
<span class="co">## These are the recommended parameters for hemibrain neurons</span>
<span class="va">neurons.flow</span> <span class="op">=</span> <span class="fu"><a href="../reference/flow_centrality.html">flow_centrality</a></span><span class="op">(</span><span class="va">neurons.checked</span>,
                               polypre <span class="op">=</span> <span class="cn">TRUE</span>,
                               mode <span class="op">=</span> <span class="st">"centrifugal"</span>,
                               split <span class="op">=</span> <span class="st">"synapses"</span><span class="op">)</span>
<span class="co">## What has this returned?</span>
<span class="co">## It is still a neuronlist object, but now more infromation has been added</span>
<span class="co">## To each neuron in the neuron list. If neuron = neurons.flow[[1]], then</span>
<span class="co">## the neuron has  flow centrality information added to neuron$d and a segregation index score. </span>
<span class="co">## The neuron$d$Label now gives the compartment, </span>
<span class="co">## where axon is Label = 2, dendrite Label = 3, primary dendrite Label = 9 </span>
<span class="co">## and primary neurite Label = 7. Soma is Label = 1.</span>
<span class="co">## (note, some outputs from various function give names rather than numbers)</span>

<span class="co">## We can see this, as so:</span>
<span class="va">neuron</span> <span class="op">=</span> <span class="va">neurons.flow</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/neuronlist-dataframe-methods.html">head</a></span><span class="op">(</span><span class="va">neuron</span><span class="op">$</span><span class="va">d</span><span class="op">)</span>
<span class="co">### standard_compartments is a helper function to change numbers to words</span>
<span class="co">### for the different compartment types.</span></code></pre></div>
<p>However, to make things easier, we can do this all in one step:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Get the split neurons</span>
<span class="va">neurons.flow</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_read_neurons.html">hemibrain_read_neurons</a></span><span class="op">(</span><span class="va">ids</span>, remote <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## This function reads neurons using neuptinr</span>
<span class="co">## If remote == TRUE, then neurons read from linked google drive. See relevant article for more information.</span></code></pre></div>
</div>
<div id="get-already-split-neurons" class="section level2">
<h2 class="hasAnchor">
<a href="#get-already-split-neurons" class="anchor"></a>Get already split neurons</h2>
<p>Splitting neurons can take a little time. We can also load thousands of pre-split neurons from the <code>hemibrainr</code> Google team drive. In order to connect R to this Google drive, you have a few options. Please see <a href="https://flyconnectome.github.io/hemibrainr/articles/google_filestream.html">this article</a>. Once you have access and have mounted the drive, you should be able to do:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># All split hemibrain neurons</span>
<span class="va">db</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_read_neurons.html">hemibrain_neurons</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">db</span><span class="op">)</span>
<span class="co">## This is a nat::neuronlistfh object.</span>
<span class="co">### This means that a data frame for the neurons and information </span>
<span class="co">### specifying where to find each neuron's data is read into R - </span>
<span class="co">### but not the whole, huge nat::neuronlist object. This saves on memory </span>
<span class="co">### for your R session. When an operation that requires the actual</span>
<span class="co">### neuron data is performed, neurons are read into R. </span>

<span class="co"># Or just load the neurons you want</span>
<span class="va">neurons.flow</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_read_neurons.html">hemibrain_read_neurons</a></span><span class="op">(</span><span class="va">ids</span>, remote <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<div id="hemibrain-select-cable" class="section level3">
<h3 class="hasAnchor">
<a href="#hemibrain-select-cable" class="anchor"></a>Hemibrain select cable</h3>
<p>If we want, we can select just the cable and synapses that constitute one of the neuron’s compartments.</p>
<p>For example:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract individual bits of cable</span>
<span class="va">axons</span> <span class="op">=</span> <span class="fu"><a href="../reference/axonic_points.html">axonic_cable</a></span><span class="op">(</span><span class="va">neurons.flow</span><span class="op">)</span>
<span class="va">dendrites</span> <span class="op">=</span> <span class="fu"><a href="../reference/axonic_points.html">dendritic_cable</a></span><span class="op">(</span><span class="va">neurons.flow</span><span class="op">)</span>
<span class="va">pnts</span> <span class="op">=</span> <span class="fu"><a href="../reference/primary_neurite.html">primary_neurite</a></span><span class="op">(</span><span class="va">neurons.flow</span><span class="op">)</span>
<span class="va">pds</span> <span class="op">=</span> <span class="fu"><a href="../reference/axonic_points.html">primary_dendrite_cable</a></span><span class="op">(</span><span class="va">neurons.flow</span><span class="op">)</span>
<span class="va">tracts</span> <span class="op">=</span> <span class="fu"><a href="../reference/axonic_points.html">tract_cable</a></span><span class="op">(</span><span class="va">neurons.flow</span><span class="op">)</span>

<span class="co"># Plot</span>
<span class="fu">nat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html">nopen3d</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/hemibrain_view.html">hemibrain_view</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">axons</span>, col <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">dendrites</span>, col <span class="op">=</span> <span class="st">"cyan"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">pnts</span>, col <span class="op">=</span> <span class="st">"purple"</span>, soma <span class="op">=</span> <span class="fl">500</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">pds</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">tracts</span>, col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>

<span class="co"># We can see, for example, just axon output synapses:</span>
<span class="va">axon.synapses</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_extract_synapses.html">hemibrain_extract_synapses</a></span><span class="op">(</span><span class="va">axons</span>, prepost <span class="op">=</span> <span class="st">"PRE"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/neuronlist-dataframe-methods.html">head</a></span><span class="op">(</span><span class="va">axon.synapses</span><span class="op">)</span></code></pre></div>
<center>
<img src="https://raw.githubusercontent.com/flyconnectome/hemibrainr/master/inst/images/tracts.png" alt="tracts">
</center>
</div>
<div id="visualise-the-split" class="section level3">
<h3 class="hasAnchor">
<a href="#visualise-the-split" class="anchor"></a>Visualise the split</h3>
<p>We can see the neruon splits, using <code><a href="../reference/plot3d_split.html">hemibrainr::plot3d_split</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot 3D</span>
<span class="fu">nat</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/nopen3d.html">nopen3d</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/hemibrain_view.html">hemibrain_view</a></span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot3d_split.html">plot3d_split</a></span><span class="op">(</span><span class="va">neurons.flow</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/nat/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">hemibrain.surf</span>, col <span class="op">=</span> <span class="st">"lightgrey"</span>, alpha <span class="op">=</span> <span class="fl">0.1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<center>
<img src="https://raw.githubusercontent.com/flyconnectome/hemibrainr/master/inst/images/plot3d_split.png" alt="plot3d_split">
</center>
<p>Here, lines: blue = dendrite, orange = axon, green = linker, purple = cell body fibre.</p>
<p>Balls: red = presynapse (output), navy blue = postsynapse (input), purple = soma.</p>
<p>We can also scan through split to see them individually, using <code><a href="../reference/plot3d_split.html">hemibrainr::nlscan_split</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Plot 3D</span>
<span class="fu">clear3d</span><span class="op">(</span><span class="op">)</span>
<span class="fu"><a href="../reference/plot3d_split.html">nlscan_split</a></span><span class="op">(</span><span class="va">neurons.flow</span><span class="op">)</span></code></pre></div>
<center>
<img src="https://raw.githubusercontent.com/flyconnectome/hemibrainr/master/inst/images/nlscan_split.png" alt="nlscan_split">
</center>
<p>So I think most of those splits are pretty convincing.</p>
</div>
<div id="split-connectivity" class="section level3">
<h3 class="hasAnchor">
<a href="#split-connectivity" class="anchor"></a>Split connectivity</h3>
<p>It will likely be important, when looking at neuron connectivity, to know whether we are examining a axo-dendritic, axo-axonic, dendro-dendritic, etc., connection.</p>
<p>We can see where synapses on these neurons lie, using:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">neuron.synapses</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_extract_synapses.html">hemibrain_extract_synapses</a></span><span class="op">(</span><span class="va">neurons.flow</span>, prepost <span class="op">=</span> <span class="st">"BOTH"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">neuron.synapses</span><span class="op">$</span><span class="va">prepost</span>, <span class="va">neuron.synapses</span><span class="op">$</span><span class="va">Label</span><span class="op">)</span></code></pre></div>
<p>Here, there is one entry per synapse. The prepost column tells us whether the synapse is presynaptic (0, an output synapse) or postsynaptic (1, an input synapse).</p>
<p>We can also easily get one entry per target-source connection, by:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Extract connections</span>
<span class="va">neuron.connections</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_extract_synapses.html">hemibrain_extract_connections</a></span><span class="op">(</span><span class="va">neurons.flow</span>, prepost <span class="op">=</span> <span class="st">"BOTH"</span><span class="op">)</span>
<span class="va">neuron.connections.strong</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">neuron.connections</span>, <span class="va">count</span> <span class="op">&gt;=</span> <span class="fl">5</span><span class="op">)</span>

<span class="co"># Connections from neurons' dendrites</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">neuron.connections.strong</span>, <span class="va">Label</span> <span class="op">==</span> <span class="st">"dendrite"</span> <span class="op">&amp;</span> <span class="va">prepost</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">count</span>,
     main<span class="op">=</span><span class="st">"Connections from neurons' dendrites"</span>,
     xlab<span class="op">=</span><span class="st">"Strength of neuron-&gt;partner synaptic connection"</span>,
     col<span class="op">=</span><span class="st">"cyan"</span>,
     freq<span class="op">=</span><span class="cn">TRUE</span>,
     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">neuron.connections.strong</span>, <span class="va">Label</span> <span class="op">==</span> <span class="st">"dendrite"</span><span class="op">)</span><span class="op">$</span><span class="va">count</span><span class="op">)</span>
<span class="op">)</span>

<span class="co"># Connections from neurons' axons</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">neuron.connections.strong</span>, <span class="va">Label</span> <span class="op">==</span> <span class="st">"axon"</span> <span class="op">&amp;</span> <span class="va">prepost</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">count</span>,
     main<span class="op">=</span><span class="st">"Maximum daily temperature at La Guardia Airport"</span>,
     xlab<span class="op">=</span><span class="st">"Strength of neuron-&gt;partner synaptic connection"</span>,
     col<span class="op">=</span><span class="st">"orange"</span>,
     freq<span class="op">=</span><span class="cn">TRUE</span>,
     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">neuron.connections.strong</span>, <span class="va">Label</span> <span class="op">==</span> <span class="st">"axon"</span><span class="op">)</span><span class="op">$</span><span class="va">count</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>Here, the prepost column tells us whether the partner is presynaptic (0, upstream source) or postsynaptic (1, downstream target).</p>
<p>We might also want to know the ‘Label’ of the partner cell. We can get an edgelist with this information:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## The function hemibrain_extract_compartment_edgelist will give an edgelist</span>
<span class="co">## for connections between the neruons you provide to it.</span>
<span class="co">## To make sure some of our randomly selected neurons connect</span>
<span class="co">## Let's also grab some PNs</span>
<span class="va">pns.flow</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_read_neurons.html">hemibrain_read_neurons</a></span><span class="op">(</span><span class="fu">hemibrainr</span><span class="fu">::</span><span class="va"><a href="../reference/classed.ids.html">upn.ids</a></span>, remote<span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">### Set remote to FALSE, if you do not have the google drive mounted.</span>

<span class="co"># Extract connections</span>
<span class="va">pns.elist</span> <span class="op">=</span> <span class="fu"><a href="../reference/hemibrain_extract_synapses.html">hemibrain_extract_compartment_edgelist</a></span><span class="op">(</span><span class="va">pns.flow</span>, .progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">pns.elist.strong</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/nat/man/subset.html">subset</a></span><span class="op">(</span><span class="va">pns.elist</span>, <span class="va">count</span> <span class="op">&gt;=</span> <span class="fl">10</span> <span class="op">|</span> <span class="va">norm</span> <span class="op">&gt;</span> <span class="fl">0.01</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">pns.elist.strong</span><span class="op">$</span><span class="va">connection</span><span class="op">)</span><span class="op">)</span>
<span class="co">## A lot of axo-axonic and dendro-dendritic action amongst the PNs</span></code></pre></div>
<p>Here, pre is the <code>bodyid</code> of the presynaptic (upstream source) neuron and post is the <code>bodyid</code> of the postsynaptic (downstream target) neuron. The <code>norm</code> column gives a synaptic weight normalised by the total inputs of the downstream neuron (post), i.e. count/total postsynapses on ‘post’.</p>
<p>Please see <a href="https://flyconnectome.github.io/hemibrainr/articles/hemibrain_connectivity.html">this article</a> to see a more in-depth example of how to efficiently work neuron connectivity data from <code>hemibrainr</code>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Alexander Bates, Gregory Jefferis.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
